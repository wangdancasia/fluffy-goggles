function OutHueTemplate = HueRedist(HueType, OutputType)
% this function outputs a hue re-distribution tempolate within [0 1] range
% based on a specified HueType and a specifed OutputType
%   HueType:
%       HSV adjusted:
%           Hue distribution from manually adjusting the colormap. The hue
%           distribution was satisfied for plotting intact skull tonotopy 
%           @ 20191202 T 21:34 using matlab colormapeditor
%       HSLuv:
%           Hue distribution from HSLuv @ http://www.hsluv.org/
%           % Saturation(HSLuv) =   70, % Lightness(HSLuv) =    71.9
%       CIELCh:
%           Using code from https://www.mathworks.com/matlabcentral/
%           fileexchange/28790-colorspace-transformations
%           @L=50, C=31
%       more details can be checked within the nested function below as
%       HueUniformityComparison      
%       return
%   OutputType:     'Circular',    covers hue from RED to RED
%                   'Linear',      covers hue from RED to PURPLE
%                   'ZigZag',      covers hue from Green Cyen to Blue
%                                       and back to Cyan and Green
%   OutHueTemplate:	the hue tempolate with more perceptual uniformity
%
%	UniformJzAzBz? TBD
HueData = GetHueData(HueType);
switch OutputType
    case 'Circular';   HueStart = 0;   HueStop = 1;     HueZigZag = 0;
    case 'Linear';     HueStart = 0;                    HueZigZag = 0;
        switch HueType
            case 'HSVadjusted';     HueStop = 10/12;
            case 'HSLuv';           HueStop = 10/12;
            case 'CIELCh';          HueStop = 11/12;
            otherwise;              HueStop = 10/12;
        end
    case 'ZigZag';      HueStart = 0;   HueStop = 1/2;	HueZigZag = 1;
    case 'ZigZagR';     HueStart = 1/2; HueStop = 1;	HueZigZag = 1;
    case 'Opposite';    HueStart = -0.1;HueStop = 1.1;	HueZigZag = 0;    
    otherwise
end
IndexHueStart =         find(HueData>HueStart, 1, 'first');
IndexHueStop =          find(HueData<HueStop, 1, 'last');
OutHueTemplate =        HueData(IndexHueStart:IndexHueStop);
if HueZigZag
    OutHueTemplate =	[OutHueTemplate; flipud(OutHueTemplate)];
end

function OutSeq = GetHueData(HueType)
% This function contains data generated by HueDistComparison.m
switch HueType
    case 'HSVadjusted', OutSeq = HSVadjusted;
    case 'HSVadjusted2',OutSeq = HSVadjusted2;
    case 'HSLuv',       OutSeq = HSLuv;
    case 'CIELCh',      OutSeq = CIELCh;
    case 'HSV0',        OutSeq = repelem([  0;  180;180; 0  ]/360, 100);
    case 'HSV30',       OutSeq = repelem([  30; 210;210;30  ]/360, 100);
    case 'HSV60',       OutSeq = repelem([  60; 240;240;60  ]/360, 100);
    case 'HSV90',       OutSeq = repelem([  90; 270;270;90  ]/360, 100);
    case 'HSV120',      OutSeq = repelem([  120;300;300;120 ]/360, 100);
    case 'HSV150',      OutSeq = repelem([  150;330;330;150 ]/360, 100);
    case 'HSV180',      OutSeq = repelem([  180;0;  0;  180 ]/360, 100);
    case 'HSV210',      OutSeq = repelem([  210;30; 30; 210 ]/360, 100);
    case 'HSV240',      OutSeq = repelem([  240;60; 60; 240 ]/360, 100);
    case 'HSV270',      OutSeq = repelem([  270;90; 90; 270 ]/360, 100);
    case 'HSV300',      OutSeq = repelem([  300;120;120;300 ]/360, 100);
    case 'HSV330',      OutSeq = repelem([  330;150;150;330 ]/360, 100);
    otherwise
end

function OutSeq = HSVadjusted
% Manually adjusted colormap, satisfied for tonotopy @ 20191202 T 21:34
OutSeq = [
        
         0
    0.0010
    0.0021
    0.0031
    0.0042
    0.0052
    0.0062
    0.0073
    0.0083
    0.0094
    0.0104
    0.0114
    0.0125
    0.0135
    0.0146
    0.0156
    0.0166
    0.0177
    0.0187
    0.0198
    0.0208
    0.0218
    0.0229
    0.0239
    0.0250
    0.0260
    0.0270
    0.0281
    0.0291
    0.0302
    0.0315
    0.0328
    0.0342
    0.0355
    0.0369
    0.0382
    0.0395
    0.0409
    0.0422
    0.0436
    0.0449
    0.0462
    0.0476
    0.0489
    0.0503
    0.0516
    0.0529
    0.0543
    0.0556
    0.0570
    0.0589
    0.0609
    0.0629
    0.0649
    0.0668
    0.0688
    0.0708
    0.0727
    0.0747
    0.0767
    0.0787
    0.0806
    0.0826
    0.0846
    0.0865
    0.0885
    0.0905
    0.0936
    0.0966
    0.0997
    0.1028
    0.1058
    0.1089
    0.1120
    0.1151
    0.1181
    0.1212
    0.1243
    0.1273
    0.1301
    0.1328
    0.1355
    0.1383
    0.1410
    0.1437
    0.1460
    0.1483
    0.1506
    0.1529
    0.1552
    0.1575
    0.1593
    0.1611
    0.1629
    0.1647
    0.1665
    0.1679
    0.1700
    0.1721
    0.1742
    0.1763
    0.1796
    0.1830
    0.1863
    0.1897
    0.1931
    0.1998
    0.2065
    0.2132
    0.2199
    0.2266
    0.2350
    0.2434
    0.2518
    0.2602
    0.2686
    0.2770
    0.2854
    0.2938
    0.3030
    0.3122
    0.3214
    0.3306
    0.3390
    0.3474
    0.3558
    0.3642
    0.3725
    0.3809
    0.3892
    0.3976
    0.4051
    0.4127
    0.4203
    0.4279
    0.4352
    0.4426
    0.4500
    0.4574
    0.4648
    0.4694
    0.4740
    0.4786
    0.4832
    0.4867
    0.4903
    0.4939
    0.4974
    0.5003
    0.5021
    0.5038
    0.5056
    0.5073
    0.5091
    0.5122
    0.5153
    0.5185
    0.5232
    0.5278
    0.5325
    0.5372
    0.5425
    0.5477
    0.5530
    0.5583
    0.5636
    0.5688
    0.5741
    0.5789
    0.5837
    0.5885
    0.5932
    0.5980
    0.6028
    0.6076
    0.6132
    0.6188
    0.6244
    0.6300
    0.6356
    0.6411
    0.6485
    0.6559
    0.6633
    0.6707
    0.6780
    0.6836
    0.6892
    0.6948
    0.7004
    0.7060
    0.7116
    0.7149
    0.7183
    0.7216
    0.7250
    0.7283
    0.7317
    0.7350
    0.7384
    0.7417
    0.7447
    0.7477
    0.7507
    0.7537
    0.7567
    0.7596
    0.7626
    0.7656
    0.7686
    0.7716
    0.7746
    0.7776
    0.7802
    0.7829
    0.7855
    0.7882
    0.7909
    0.7935
    0.7962
    0.7988
    0.8015
    0.8042
    0.8068
    0.8095
    0.8121
    0.8148
    0.8168
    0.8188
    0.8209
    0.8229
    0.8249
    0.8269
    0.8289
    0.8310
    0.8330
    0.8343
    0.8364
    0.8384
    0.8404
    0.8424
    0.8444
    0.8465
    0.8485
    0.8505
    0.8525
    0.8544
    0.8564
    0.8583
    0.8602
    0.8622
    0.8641
    0.8661
    0.8680
    0.8700
    0.8719
    0.8739
    0.8758
    0.8778
    0.8797
    0.8817
    0.8836
    0.8856
    0.8875
    0.8902
    0.8928
    0.8955
    0.8981
    0.9008
    0.9034
    0.9060
    0.9087
    0.9113
    0.9140
    0.9166
    0.9193
    0.9219
    0.9246
    0.9281
    0.9314
    0.9348
    0.9381
    0.9415
    0.9449
    0.9482
    0.9516
    0.9549
    0.9583
    0.9617
    0.9650
    0.9684
    0.9717
    0.9751
    0.9785
    0.9818
    0.9852
    0.9885
    0.9919
    0.9952
    0.9986
    1.0000];

function OutSeq = HSVadjusted2
% This function contains data manually adjusted from HSV colormap 
% less red than y @ 20191202 T 21:34
OutSeq = ...
[	                  0
    0.0014
    0.0027
    0.0041
    0.0055
    0.0068
    0.0082
    0.0096
    0.0109
    0.0123
    0.0137
    0.0150
    0.0164
    0.0178
    0.0191
    0.0205
    0.0219
    0.0232
    0.0246
    0.0260
    0.0273
    0.0287
    0.0301
    0.0314
    0.0328
    0.0342
    0.0355
    0.0369
    0.0384
    0.0400
    0.0415
    0.0430
    0.0446
    0.0461
    0.0476
    0.0492
    0.0507
    0.0523
    0.0538
    0.0553
    0.0569
    0.0584
    0.0599
    0.0615
    0.0630
    0.0645
    0.0661
    0.0676
    0.0692
    0.0707
    0.0722
    0.0738
    0.0761
    0.0784
    0.0807
    0.0830
    0.0853
    0.0876
    0.0899
    0.0922
    0.0945
    0.0968
    0.0991
    0.1014
    0.1037
    0.1060
    0.1083
    0.1106
    0.1133
    0.1160
    0.1187
    0.1214
    0.1241
    0.1267
    0.1294
    0.1321
    0.1348
    0.1375
    0.1402
    0.1428
    0.1455
    0.1482
    0.1509
    0.1532
    0.1556
    0.1579
    0.1603
    0.1626
    0.1650
    0.1667
    0.1690
    0.1714
    0.1737
    0.1761
    0.1784
    0.1808
    0.1831
    0.1872
    0.1913
    0.1954
    0.1995
    0.2036
    0.2077
    0.2118
    0.2159
    0.2200
    0.2261
    0.2323
    0.2384
    0.2446
    0.2507
    0.2569
    0.2636
    0.2703
    0.2770
    0.2837
    0.2904
    0.2996
    0.3088
    0.3181
    0.3273
    0.3357
    0.3440
    0.3524
    0.3608
    0.3682
    0.3755
    0.3829
    0.3902
    0.3976
    0.4032
    0.4088
    0.4144
    0.4201
    0.4257
    0.4313
    0.4369
    0.4425
    0.4482
    0.4538
    0.4594
    0.4650
    0.4691
    0.4733
    0.4775
    0.4816
    0.4858
    0.4900
    0.4941
    0.4983
    0.5017
    0.5057
    0.5097
    0.5137
    0.5178
    0.5218
    0.5258
    0.5298
    0.5339
    0.5372
    0.5406
    0.5439
    0.5473
    0.5506
    0.5540
    0.5573
    0.5607
    0.5640
    0.5683
    0.5727
    0.5770
    0.5813
    0.5856
    0.5899
    0.5942
    0.5985
    0.6028
    0.6071
    0.6115
    0.6158
    0.6201
    0.6244
    0.6300
    0.6356
    0.6411
    0.6467
    0.6523
    0.6579
    0.6635
    0.6691
    0.6747
    0.6803
    0.6859
    0.6914
    0.6952
    0.6989
    0.7026
    0.7064
    0.7101
    0.7138
    0.7175
    0.7213
    0.7250
    0.7284
    0.7317
    0.7351
    0.7384
    0.7418
    0.7451
    0.7485
    0.7518
    0.7552
    0.7585
    0.7619
    0.7646
    0.7674
    0.7702
    0.7730
    0.7757
    0.7785
    0.7813
    0.7840
    0.7868
    0.7896
    0.7924
    0.7951
    0.7972
    0.7994
    0.8015
    0.8036
    0.8057
    0.8078
    0.8099
    0.8120
    0.8141
    0.8162
    0.8184
    0.8205
    0.8226
    0.8247
    0.8268
    0.8289
    0.8308
    0.8326
    0.8338
    0.8357
    0.8376
    0.8394
    0.8413
    0.8432
    0.8450
    0.8469
    0.8487
    0.8506
    0.8525
    0.8543
    0.8562
    0.8580
    0.8607
    0.8633
    0.8659
    0.8686
    0.8712
    0.8738
    0.8764
    0.8791
    0.8817
    0.8843
    0.8870
    0.8896
    0.8922
    0.8949
    0.8979
    0.9010
    0.9041
    0.9071
    0.9102
    0.9133
    0.9163
    0.9194
    0.9225
    0.9255
    0.9286
    0.9317
    0.9350
    0.9384
    0.9417
    0.9451
    0.9484
    0.9518
    0.9551
    0.9584
    0.9618
    0.9671
    0.9723
    0.9776
    0.9828
    0.9881
    0.9933
    0.9986];

function OutSeq = HSLuv
% This function contains data generated by HueDistComparison.m
OutSeq = ...
[	0.0010
    0.0025
    0.0040
    0.0055
    0.0069
    0.0084
    0.0099
    0.0113
    0.0127
    0.0142
    0.0156
    0.0170
    0.0184
    0.0198
    0.0212
    0.0226
    0.0240
    0.0254
    0.0267
    0.0281
    0.0295
    0.0308
    0.0322
    0.0335
    0.0349
    0.0362
    0.0376
    0.0389
    0.0403
    0.0416
    0.0429
    0.0443
    0.0456
    0.0469
    0.0483
    0.0496
    0.0510
    0.0523
    0.0536
    0.0550
    0.0563
    0.0577
    0.0591
    0.0604
    0.0618
    0.0632
    0.0645
    0.0659
    0.0673
    0.0687
    0.0701
    0.0716
    0.0730
    0.0742
    0.0751
    0.0760
    0.0769
    0.0778
    0.0787
    0.0796
    0.0804
    0.0813
    0.0822
    0.0831
    0.0839
    0.0848
    0.0857
    0.0865
    0.0874
    0.0882
    0.0891
    0.0899
    0.0908
    0.0916
    0.0925
    0.0933
    0.0942
    0.0950
    0.0959
    0.0967
    0.0976
    0.0984
    0.0993
    0.1001
    0.1010
    0.1019
    0.1027
    0.1036
    0.1044
    0.1053
    0.1062
    0.1070
    0.1079
    0.1088
    0.1096
    0.1105
    0.1114
    0.1123
    0.1132
    0.1141
    0.1150
    0.1159
    0.1168
    0.1177
    0.1186
    0.1195
    0.1204
    0.1214
    0.1223
    0.1233
    0.1242
    0.1252
    0.1261
    0.1271
    0.1281
    0.1291
    0.1301
    0.1311
    0.1321
    0.1331
    0.1341
    0.1352
    0.1362
    0.1373
    0.1384
    0.1394
    0.1405
    0.1416
    0.1428
    0.1439
    0.1450
    0.1462
    0.1474
    0.1486
    0.1498
    0.1510
    0.1522
    0.1535
    0.1547
    0.1560
    0.1573
    0.1586
    0.1600
    0.1614
    0.1627
    0.1641
    0.1656
    0.1670
    0.1685
    0.1700
    0.1714
    0.1729
    0.1743
    0.1758
    0.1773
    0.1787
    0.1802
    0.1817
    0.1831
    0.1846
    0.1861
    0.1876
    0.1890
    0.1905
    0.1920
    0.1935
    0.1950
    0.1965
    0.1980
    0.1995
    0.2011
    0.2026
    0.2041
    0.2057
    0.2072
    0.2088
    0.2103
    0.2119
    0.2135
    0.2151
    0.2167
    0.2183
    0.2199
    0.2216
    0.2232
    0.2249
    0.2266
    0.2283
    0.2300
    0.2317
    0.2334
    0.2352
    0.2370
    0.2388
    0.2406
    0.2424
    0.2443
    0.2461
    0.2480
    0.2499
    0.2519
    0.2539
    0.2559
    0.2579
    0.2599
    0.2620
    0.2642
    0.2663
    0.2685
    0.2707
    0.2730
    0.2753
    0.2777
    0.2801
    0.2825
    0.2850
    0.2876
    0.2902
    0.2929
    0.2956
    0.2984
    0.3013
    0.3042
    0.3073
    0.3104
    0.3137
    0.3170
    0.3205
    0.3240
    0.3278
    0.3316
    0.3356
    0.3394
    0.3430
    0.3465
    0.3497
    0.3529
    0.3559
    0.3588
    0.3616
    0.3643
    0.3670
    0.3695
    0.3719
    0.3743
    0.3766
    0.3788
    0.3810
    0.3831
    0.3851
    0.3871
    0.3890
    0.3909
    0.3928
    0.3946
    0.3963
    0.3980
    0.3997
    0.4014
    0.4030
    0.4046
    0.4061
    0.4076
    0.4091
    0.4106
    0.4120
    0.4134
    0.4148
    0.4162
    0.4175
    0.4189
    0.4202
    0.4214
    0.4227
    0.4239
    0.4252
    0.4264
    0.4276
    0.4287
    0.4299
    0.4310
    0.4322
    0.4333
    0.4344
    0.4355
    0.4365
    0.4376
    0.4386
    0.4397
    0.4407
    0.4417
    0.4427
    0.4437
    0.4447
    0.4457
    0.4467
    0.4476
    0.4486
    0.4495
    0.4505
    0.4514
    0.4523
    0.4532
    0.4541
    0.4550
    0.4559
    0.4568
    0.4577
    0.4586
    0.4594
    0.4603
    0.4612
    0.4620
    0.4629
    0.4637
    0.4646
    0.4654
    0.4662
    0.4671
    0.4679
    0.4687
    0.4695
    0.4704
    0.4712
    0.4720
    0.4728
    0.4736
    0.4744
    0.4752
    0.4760
    0.4768
    0.4776
    0.4784
    0.4792
    0.4800
    0.4808
    0.4816
    0.4823
    0.4831
    0.4839
    0.4847
    0.4855
    0.4863
    0.4871
    0.4878
    0.4886
    0.4894
    0.4902
    0.4910
    0.4918
    0.4926
    0.4934
    0.4941
    0.4949
    0.4957
    0.4965
    0.4973
    0.4981
    0.4989
    0.4997
    0.5005
    0.5013
    0.5021
    0.5029
    0.5037
    0.5044
    0.5052
    0.5060
    0.5068
    0.5075
    0.5083
    0.5090
    0.5098
    0.5105
    0.5113
    0.5120
    0.5127
    0.5135
    0.5142
    0.5149
    0.5156
    0.5164
    0.5171
    0.5178
    0.5185
    0.5192
    0.5199
    0.5207
    0.5214
    0.5221
    0.5228
    0.5235
    0.5242
    0.5249
    0.5256
    0.5263
    0.5270
    0.5277
    0.5284
    0.5291
    0.5298
    0.5305
    0.5312
    0.5319
    0.5326
    0.5333
    0.5341
    0.5348
    0.5355
    0.5362
    0.5369
    0.5376
    0.5383
    0.5390
    0.5397
    0.5405
    0.5412
    0.5419
    0.5426
    0.5434
    0.5441
    0.5448
    0.5456
    0.5463
    0.5470
    0.5478
    0.5485
    0.5493
    0.5500
    0.5508
    0.5516
    0.5523
    0.5531
    0.5539
    0.5547
    0.5555
    0.5563
    0.5570
    0.5579
    0.5587
    0.5595
    0.5603
    0.5611
    0.5620
    0.5628
    0.5638
    0.5650
    0.5662
    0.5675
    0.5687
    0.5700
    0.5712
    0.5725
    0.5737
    0.5750
    0.5763
    0.5776
    0.5789
    0.5802
    0.5815
    0.5828
    0.5842
    0.5855
    0.5869
    0.5883
    0.5896
    0.5911
    0.5925
    0.5939
    0.5953
    0.5968
    0.5983
    0.5998
    0.6013
    0.6028
    0.6043
    0.6059
    0.6075
    0.6091
    0.6107
    0.6123
    0.6140
    0.6157
    0.6174
    0.6191
    0.6209
    0.6226
    0.6244
    0.6263
    0.6281
    0.6300
    0.6319
    0.6338
    0.6358
    0.6378
    0.6398
    0.6419
    0.6440
    0.6462
    0.6483
    0.6506
    0.6528
    0.6551
    0.6575
    0.6599
    0.6623
    0.6648
    0.6673
    0.6698
    0.6723
    0.6748
    0.6773
    0.6797
    0.6821
    0.6845
    0.6868
    0.6892
    0.6915
    0.6938
    0.6961
    0.6984
    0.7006
    0.7028
    0.7051
    0.7073
    0.7094
    0.7116
    0.7137
    0.7159
    0.7180
    0.7201
    0.7222
    0.7243
    0.7263
    0.7284
    0.7304
    0.7325
    0.7345
    0.7365
    0.7385
    0.7405
    0.7425
    0.7444
    0.7464
    0.7484
    0.7503
    0.7522
    0.7542
    0.7561
    0.7580
    0.7599
    0.7618
    0.7637
    0.7656
    0.7674
    0.7693
    0.7712
    0.7730
    0.7749
    0.7767
    0.7786
    0.7804
    0.7822
    0.7841
    0.7859
    0.7877
    0.7895
    0.7914
    0.7932
    0.7950
    0.7968
    0.7986
    0.8004
    0.8022
    0.8040
    0.8058
    0.8076
    0.8094
    0.8112
    0.8130
    0.8147
    0.8165
    0.8183
    0.8201
    0.8219
    0.8237
    0.8254
    0.8272
    0.8290
    0.8308
    0.8326
    0.8343
    0.8361
    0.8378
    0.8395
    0.8412
    0.8429
    0.8445
    0.8462
    0.8478
    0.8494
    0.8509
    0.8525
    0.8540
    0.8555
    0.8571
    0.8585
    0.8600
    0.8615
    0.8629
    0.8644
    0.8658
    0.8672
    0.8686
    0.8700
    0.8713
    0.8727
    0.8741
    0.8754
    0.8767
    0.8780
    0.8794
    0.8807
    0.8819
    0.8832
    0.8845
    0.8858
    0.8870
    0.8883
    0.8895
    0.8908
    0.8920
    0.8932
    0.8945
    0.8957
    0.8969
    0.8981
    0.8993
    0.9005
    0.9017
    0.9028
    0.9040
    0.9052
    0.9064
    0.9075
    0.9087
    0.9099
    0.9110
    0.9122
    0.9133
    0.9145
    0.9156
    0.9168
    0.9179
    0.9191
    0.9202
    0.9213
    0.9225
    0.9236
    0.9248
    0.9259
    0.9270
    0.9282
    0.9293
    0.9304
    0.9316
    0.9327
    0.9338
    0.9350
    0.9361
    0.9373
    0.9384
    0.9395
    0.9407
    0.9418
    0.9430
    0.9441
    0.9453
    0.9465
    0.9476
    0.9488
    0.9500
    0.9511
    0.9523
    0.9535
    0.9547
    0.9559
    0.9571
    0.9583
    0.9595
    0.9607
    0.9619
    0.9631
    0.9643
    0.9656
    0.9668
    0.9681
    0.9693
    0.9706
    0.9719
    0.9731
    0.9744
    0.9757
    0.9770
    0.9783
    0.9797
    0.9810
    0.9824
    0.9837
    0.9851
    0.9865
    0.9878
    0.9893
    0.9907
    0.9921
    0.9935
    0.9950
    0.9965
    0.9980
    0.9995];

function OutSeq = CIELCh
% This function contains data generated by HueDistComparison.m
OutSeq = ...
[	0.0001
    0.0013
    0.0024
    0.0036
    0.0047
    0.0058
    0.0069
    0.0080
    0.0091
    0.0102
    0.0112
    0.0123
    0.0133
    0.0144
    0.0154
    0.0164
    0.0175
    0.0185
    0.0195
    0.0205
    0.0215
    0.0225
    0.0234
    0.0244
    0.0254
    0.0264
    0.0273
    0.0283
    0.0292
    0.0302
    0.0311
    0.0320
    0.0330
    0.0339
    0.0348
    0.0357
    0.0366
    0.0375
    0.0384
    0.0393
    0.0402
    0.0411
    0.0420
    0.0429
    0.0438
    0.0447
    0.0456
    0.0464
    0.0473
    0.0482
    0.0490
    0.0499
    0.0508
    0.0516
    0.0525
    0.0533
    0.0542
    0.0550
    0.0559
    0.0567
    0.0576
    0.0584
    0.0593
    0.0601
    0.0610
    0.0618
    0.0627
    0.0635
    0.0643
    0.0652
    0.0660
    0.0668
    0.0677
    0.0685
    0.0694
    0.0702
    0.0710
    0.0719
    0.0727
    0.0735
    0.0744
    0.0752
    0.0760
    0.0769
    0.0777
    0.0786
    0.0794
    0.0802
    0.0811
    0.0819
    0.0828
    0.0836
    0.0845
    0.0853
    0.0862
    0.0870
    0.0879
    0.0888
    0.0896
    0.0905
    0.0914
    0.0922
    0.0931
    0.0940
    0.0949
    0.0957
    0.0966
    0.0975
    0.0984
    0.0993
    0.1002
    0.1011
    0.1021
    0.1030
    0.1039
    0.1048
    0.1058
    0.1067
    0.1077
    0.1086
    0.1096
    0.1105
    0.1115
    0.1125
    0.1135
    0.1145
    0.1155
    0.1165
    0.1175
    0.1186
    0.1196
    0.1207
    0.1217
    0.1228
    0.1239
    0.1250
    0.1261
    0.1272
    0.1284
    0.1295
    0.1307
    0.1318
    0.1330
    0.1342
    0.1355
    0.1367
    0.1380
    0.1392
    0.1405
    0.1419
    0.1432
    0.1446
    0.1459
    0.1473
    0.1488
    0.1502
    0.1517
    0.1532
    0.1547
    0.1563
    0.1579
    0.1595
    0.1612
    0.1629
    0.1646
    0.1664
    0.1682
    0.1700
    0.1718
    0.1736
    0.1754
    0.1772
    0.1790
    0.1808
    0.1827
    0.1845
    0.1863
    0.1882
    0.1900
    0.1919
    0.1937
    0.1956
    0.1975
    0.1994
    0.2013
    0.2032
    0.2051
    0.2070
    0.2090
    0.2109
    0.2129
    0.2149
    0.2168
    0.2189
    0.2209
    0.2229
    0.2250
    0.2270
    0.2291
    0.2312
    0.2333
    0.2355
    0.2377
    0.2398
    0.2420
    0.2443
    0.2465
    0.2488
    0.2511
    0.2534
    0.2557
    0.2581
    0.2605
    0.2630
    0.2654
    0.2679
    0.2704
    0.2730
    0.2756
    0.2782
    0.2808
    0.2835
    0.2862
    0.2890
    0.2918
    0.2946
    0.2975
    0.3005
    0.3034
    0.3065
    0.3095
    0.3126
    0.3158
    0.3190
    0.3223
    0.3256
    0.3290
    0.3325
    0.3359
    0.3393
    0.3426
    0.3459
    0.3490
    0.3521
    0.3551
    0.3581
    0.3610
    0.3638
    0.3666
    0.3693
    0.3720
    0.3746
    0.3771
    0.3796
    0.3821
    0.3845
    0.3869
    0.3892
    0.3915
    0.3937
    0.3959
    0.3981
    0.4002
    0.4023
    0.4043
    0.4063
    0.4083
    0.4103
    0.4122
    0.4141
    0.4159
    0.4177
    0.4195
    0.4213
    0.4230
    0.4247
    0.4264
    0.4281
    0.4297
    0.4313
    0.4329
    0.4345
    0.4360
    0.4375
    0.4390
    0.4405
    0.4420
    0.4434
    0.4448
    0.4462
    0.4476
    0.4489
    0.4502
    0.4516
    0.4529
    0.4541
    0.4554
    0.4566
    0.4579
    0.4591
    0.4603
    0.4614
    0.4626
    0.4638
    0.4649
    0.4660
    0.4671
    0.4682
    0.4693
    0.4703
    0.4714
    0.4724
    0.4734
    0.4744
    0.4754
    0.4764
    0.4773
    0.4783
    0.4792
    0.4801
    0.4810
    0.4819
    0.4828
    0.4837
    0.4845
    0.4854
    0.4862
    0.4870
    0.4878
    0.4886
    0.4894
    0.4902
    0.4909
    0.4917
    0.4924
    0.4931
    0.4939
    0.4946
    0.4952
    0.4959
    0.4966
    0.4972
    0.4978
    0.4984
    0.4990
    0.4996
    0.5001
    0.5007
    0.5013
    0.5018
    0.5023
    0.5029
    0.5034
    0.5039
    0.5045
    0.5050
    0.5055
    0.5060
    0.5065
    0.5070
    0.5075
    0.5080
    0.5085
    0.5090
    0.5094
    0.5099
    0.5104
    0.5108
    0.5113
    0.5118
    0.5122
    0.5127
    0.5131
    0.5136
    0.5140
    0.5144
    0.5149
    0.5153
    0.5157
    0.5162
    0.5166
    0.5170
    0.5174
    0.5179
    0.5183
    0.5187
    0.5191
    0.5195
    0.5199
    0.5203
    0.5207
    0.5211
    0.5215
    0.5219
    0.5223
    0.5227
    0.5231
    0.5235
    0.5238
    0.5242
    0.5246
    0.5250
    0.5254
    0.5258
    0.5261
    0.5265
    0.5269
    0.5273
    0.5276
    0.5280
    0.5284
    0.5288
    0.5291
    0.5295
    0.5299
    0.5303
    0.5306
    0.5310
    0.5314
    0.5317
    0.5321
    0.5326
    0.5333
    0.5340
    0.5347
    0.5354
    0.5362
    0.5370
    0.5377
    0.5385
    0.5392
    0.5399
    0.5406
    0.5413
    0.5420
    0.5427
    0.5434
    0.5441
    0.5448
    0.5455
    0.5462
    0.5469
    0.5476
    0.5484
    0.5491
    0.5498
    0.5505
    0.5512
    0.5519
    0.5526
    0.5533
    0.5541
    0.5548
    0.5555
    0.5563
    0.5570
    0.5577
    0.5585
    0.5592
    0.5600
    0.5608
    0.5615
    0.5623
    0.5631
    0.5639
    0.5647
    0.5654
    0.5662
    0.5671
    0.5679
    0.5687
    0.5695
    0.5703
    0.5712
    0.5720
    0.5729
    0.5738
    0.5746
    0.5755
    0.5764
    0.5773
    0.5782
    0.5791
    0.5800
    0.5810
    0.5819
    0.5829
    0.5838
    0.5848
    0.5858
    0.5868
    0.5878
    0.5888
    0.5899
    0.5909
    0.5920
    0.5930
    0.5941
    0.5952
    0.5964
    0.5975
    0.5986
    0.5998
    0.6010
    0.6022
    0.6034
    0.6046
    0.6059
    0.6072
    0.6085
    0.6098
    0.6111
    0.6125
    0.6139
    0.6153
    0.6167
    0.6181
    0.6196
    0.6211
    0.6227
    0.6242
    0.6258
    0.6275
    0.6291
    0.6308
    0.6326
    0.6343
    0.6361
    0.6380
    0.6399
    0.6418
    0.6438
    0.6458
    0.6478
    0.6500
    0.6521
    0.6544
    0.6566
    0.6590
    0.6614
    0.6638
    0.6664
    0.6690
    0.6715
    0.6741
    0.6766
    0.6792
    0.6817
    0.6843
    0.6868
    0.6893
    0.6919
    0.6944
    0.6969
    0.6994
    0.7019
    0.7044
    0.7069
    0.7094
    0.7119
    0.7144
    0.7169
    0.7194
    0.7219
    0.7244
    0.7269
    0.7294
    0.7319
    0.7345
    0.7370
    0.7395
    0.7420
    0.7445
    0.7470
    0.7496
    0.7521
    0.7547
    0.7572
    0.7598
    0.7623
    0.7649
    0.7675
    0.7701
    0.7726
    0.7753
    0.7779
    0.7805
    0.7831
    0.7858
    0.7884
    0.7911
    0.7938
    0.7965
    0.7992
    0.8019
    0.8047
    0.8075
    0.8102
    0.8130
    0.8159
    0.8187
    0.8215
    0.8244
    0.8273
    0.8302
    0.8332
    0.8361
    0.8390
    0.8417
    0.8444
    0.8471
    0.8496
    0.8521
    0.8546
    0.8570
    0.8593
    0.8616
    0.8639
    0.8661
    0.8682
    0.8703
    0.8724
    0.8744
    0.8764
    0.8783
    0.8802
    0.8821
    0.8839
    0.8858
    0.8875
    0.8893
    0.8910
    0.8927
    0.8944
    0.8960
    0.8977
    0.8993
    0.9008
    0.9024
    0.9039
    0.9054
    0.9069
    0.9084
    0.9099
    0.9113
    0.9127
    0.9141
    0.9155
    0.9169
    0.9183
    0.9196
    0.9209
    0.9223
    0.9236
    0.9249
    0.9262
    0.9274
    0.9287
    0.9299
    0.9312
    0.9324
    0.9337
    0.9349
    0.9361
    0.9373
    0.9385
    0.9397
    0.9408
    0.9420
    0.9432
    0.9443
    0.9455
    0.9466
    0.9478
    0.9489
    0.9501
    0.9512
    0.9523
    0.9534
    0.9546
    0.9557
    0.9568
    0.9579
    0.9590
    0.9601
    0.9612
    0.9623
    0.9634
    0.9645
    0.9656
    0.9667
    0.9678
    0.9689
    0.9700
    0.9711
    0.9722
    0.9733
    0.9744
    0.9755
    0.9766
    0.9777
    0.9788
    0.9799
    0.9810
    0.9821
    0.9832
    0.9843
    0.9854
    0.9865
    0.9876
    0.9887
    0.9899
    0.9910
    0.9921
    0.9933
    0.9944
    0.9955
    0.9967
    0.9978
    0.9990];

function HueUniformityComparison
% This code is for demonstrating perceptual hue distribution among
% different color spaces
%   HSV:            The standard HSV
%   HSLuv:          Hue distribution on Sat=100, L=60 @ http://www.hsluv.org/
%   CIELCh:         Using code from https://www.mathworks.com/matlabcentral/fileexchange/28790-colorspace-transformations
%   CIECAM02:       ?
%   CIECAM06-UCS:   ?
%   JzAzBz:         ?

%% Shared Settings
clear H;
global H
% H0 =	(0:0.5:359.5)';
H0 =	linspace(0, 359.5, 300)';
Hnum =	length(H0);
S0 =	ones(Hnum,1);
figure(     'Units',            'normalized');

%% HSV
i = 1;
H{i}.Name =             'HSV';
H{i}.ColormapHSV =      [H0/360 S0 S0];
H{i}.Colormap =         hsv2rgb(H{1}.ColormapHSV);
    
%% HSLuv (CIELuv)
% http://www.hsluv.org/
% Saturation(HSLuv) =   70
% Lightness(HSLuv) =    71.9
i = 2;
H{i}.Name =             'HSLuv @S=70, L=71.9';
H{i}.Colormap1 =        zeros(Hnum,3);
for j = 1:Hnum
%     H{i}.Colormap1(j,:) =   cell2mat(cell(py.hsluv.hsluv_to_rgb([H0(j) 70 71.9])));
end
H{i}.Colormap2 =        rgb2hsv(H{i}.Colormap1);
H{i}.Colormap2I =       find(H{i}.Colormap2(:,1)<0.5, 1);
H{i}.ColormapHSV =      H{i}.Colormap2([H{i}.Colormap2I:end 1:(H{i}.Colormap2I-1)],:);
H{i}.Colormap =         hsv2rgb([H{i}.ColormapHSV(:,1) S0 S0]);           

%% CIELCh
% code from https://www.mathworks.com/matlabcentral/fileexchange/28790-colorspace-transformations
% 
i = 3;
H{i}.Name =             'CIELCh @L=50, C=31';
addpath 'D:\User_SONG Xindong\Downloads\colorspace\colorspace'
H{i}.Colormap1 =        colorspace('lch->hsv', [50*S0 31*S0 H0]);
H{i}.Colormap1I =       find(H{i}.Colormap1(:,1)<180, 1);
H{i}.ColormapHSV =      H{i}.Colormap1([H{i}.Colormap1I:end 1:(H{i}.Colormap1I-1)],:)/360;
H{i}.Colormap =         hsv2rgb([H{i}.ColormapHSV(:,1) S0 S0]);

%% HSV adjusted
% from the 20191202 manually adjusted HSV map
i = 4;
H{i}.Name =             'HSV adjusted';
H{i}.ColormapHSV =      [HSVadjusted, S0 S0];
H{i}.Colormap =         hsv2rgb(H{i}.ColormapHSV);

%% Plot the result
mapnum = length(H);
for i = 1:mapnum
    disp(i)
    gh.axes(i) = axes(...
            'position',         [   0.05, ...
                                    0.9 - (0.9/mapnum)*i, ...
                                    0.9,...
                                    0.1],...
            'XLim',             [0 10],...
            'XTick',            0:1:10,...
            'YTick',            []);
    colormap(gh.axes(i),            H{i}.Colormap);
    gh.colorbar(i) =                colorbar('SouthOutSide');
    gh.test(i) = ylabel(gh.colorbar(i),     H{i}.Name);
    gh.colorbar(i).Position(4) =    1/2/length(H);
    gh.colorbar(i).Ticks =          [];
end

figure
plot(H0, H0);                           hold on;
plot(H0, H{2}.ColormapHSV(:,1)*360);
plot(H0, H{3}.ColormapHSV(:,1)*360);
plot(H0, H{4}.ColormapHSV(:,1)*360);
legend(H{1}.Name, H{2}.Name, H{3}.Name,  H{4}.Name,...
            'Location',        'NorthWest');  
xlabel('HSV angle');
ylabel('Test angle');

%% Old design comments
% a standard colormap has 64 color steps
% Generate a colormap HuvSV, which has
%   H(Huv):     matching HSLuv's "Hue" distribution, to have a more 
%               perceptually uniform hue. http://www.hsluv.org/
%   S:          matching HSV's "Saturation"=1, to utilize the max contrast
%               on a RGB display device
%   V:          matching HSV's "Value"=1, to utilize the max contrast
%               on a RGB display device
% 
% HsvName{1} = 'Uniform Hue (Circular)';
% HsvName{2} = 'Uniform Hue (Linear)';
% HsvName{3} = 'Uniform Hue (Reciprocating)';
% Hsv{2} =  linspace(0, 330, 64)';                           % linear hue
% Hsv{3} = [linspace(0, 330, 32) linspace(330, 0, 32)]';     % reciprocating hue

function OutHueTemplate = UniformJzAzBz(OutputType)
%   Template picture from https://observablehq.com/@jrus/diffused-gamut-picture
% Just started, plan to read and interpolate from JzAzBz png picture



